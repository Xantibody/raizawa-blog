---
date: 2026-02-08 00:10
title: Rustの勉強[Cargo、Crates.io その1]
category: ぎじゅつ
draft: false
tags:
  - Rust
---

## はじめに

<https://doc.rust-jp.rs/book-ja/>
を読んでいる

- 本日2回目だがなんとかサボらずできている

## お勉強

https://doc.rust-jp.rs/book-ja/ch14-00-more-about-cargo.html#cargoとcratesioについてより詳しく

今日はここ

### メモ

- 詳しく見過ぎる必要がないといわれたので本当に光るところだけ読む

> crates.ioでライブラリを公開する

- 実はこれだけ気になっている

#### リリースプロファイルでビルドをカスタマイズする

```bash
$ cargo build
    Finished dev [unoptimized + debuginfo] target(s) in 0.0 secs
$ cargo build --release
    Finished release [optimized] target(s) in 0.0 secs
```

- これね
- `--release`ってよくClaude Codeが使うからなんかそれっぽいんだろうなとしか思っていなかった
- `[profile.release]`をtomlに定義する必要があるんやな
- まあ、ほかの言語でもあるやつ

#### Crates.ioにクレートを公開する

- 気になるやつきた

> アカウントを作成し、APIトークンを保存し、クレートの名前を決め、必要なメタデータを指定したので、 公開する準備が整いました！クレートを公開すると、特定のバージョンが、 crates.ioに他の人が使用できるようにアップロードされます。

- なるほどね
- とりあえずこれで公開ができるんだな

https://semver.org/

- これ知らなかった
- `cargo yank`でバージョンを取り下げられるらしい
- 公開前にライセンスなどのメタデータとコメントで補助したほうが良さそう
- 公開するときにここのページを参考にコメント書こう

https://doc.rust-jp.rs/book-ja/ch14-02-publishing-to-crates-io.html

#### Cargoのワークスペース

- これ個人プロジェクトで採用しようとしたけどリポジトリ分けちゃった

```bash
├── Cargo.lock
├── Cargo.toml
├── add-one
│   ├── Cargo.toml
│   └── src
│       └── lib.rs
├── adder
│   ├── Cargo.toml
│   └── src
│       └── main.rs
└── target
```

- なるほどね、こうなるんだ

> ワークスペースには、各クレートのディレクトリそれぞれにCargo.lockが存在するのではなく、 ワークスペースの最上位階層にただ一つのCargo.lockが存在するだけのことに注目してください。

- これ知らなかった
- あとはtestとかbuildに`-p`でパッケージ名を渡せば各々実行できるっぽい
  - 引数なしは全体

#### cargo installでCrates.ioからバイナリをインストールする

> 独自の設定を何も行なっていなければ、このディレクトリは、$HOME/.cargo/binになります。

- へーそうなんだ
- goでもあったような
- まあnix使うけれども

#### 独自のコマンドでCargoを拡張する

- なんぞこれ

> $PATHにあるバイナリがcargo-somethingという名前なら、cargo something

- ふーん
- 使わなさそう。。。

#### スマートポインタ

- でかい章きたな
- ざっくりよんだけどわからん
- とりあえず今までの章にでてきたらしい

## まとめ

- 光らせることが少しできた
  - 気になっていた所を注視して読めた
- 得に細かいところはなくて、Tips程度だった
  - 次のスマートポインタは中々手ごわそうな予感がしている

次ここ
https://doc.rust-jp.rs/book-ja/ch15-01-box.html
