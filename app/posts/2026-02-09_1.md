---
date: 2026-02-09 14:16
title: Rustの勉強[Box<T> その2]
category: ぎじゅつ
draft: false
tags:
  - Rust
---

## はじめに

<https://doc.rust-jp.rs/book-ja/>
を読んでいる

## お勉強

https://doc.rust-jp.rs/book-ja/ch15-01-box.html#%E9%9D%9E%E5%86%8D%E5%B8%B0%E7%9A%84%E3%81%AA%E5%9E%8B%E3%81%AE%E3%82%B5%E3%82%A4%E3%82%BA%E3%82%92%E8%A8%88%E7%AE%97%E3%81%99%E3%82%8B
をやる

- 休日試した電車勉強を出勤でやってみる

### メモ

- 光らなさすぎて再帰的なことという認識しかない
  - と思ったら非再帰がでてきてしまった

> コンパイラは`Cons`列挙子を見ることから始めます。

- `Cons`抜かしたので何を言っているかわからなかったので終わった
  - 調べ直す

- そうだそうだ、中身が無限に続くやつね
- あーだから再帰的なのか
- サイズを決めようとした時に再帰的になり無限ループが起きるところまで理解
- とりあえず予測する計算に無限ループが起きることを理解した

> 再帰的に定義された型に必要なメモリ量を計算できないので

- 多分これがすべてで、これのためにポインタ置き場を借りに作るだけか
- コンパイラのための型
- 可変ではなくそれらを参照するポインタを置く型か

> より多くのボックスのユースケースは第17章でもお見かけするでしょう

- はい、とっとと次

#### Derefトレイトでスマートポインタを普通の参照のように扱う

- `Box`は型だったからtrait版と予想
- 構成的には最初`Box`の説明してこっちに入れ替えるように書くらしい

```rust
fn main() {
    let x = 5;
    let y = &x;

    assert_eq!(5, x);
    assert_eq!(5, *y);
}
```

- これ`*y`を外したらなんで動かないかわからん

## まとめ

- `Box`の概要を理解できた
  - おそらくスマートポインタはコンパイラのためのサイズ計算が無限ループしてしまうのを防ぐための参照
  - ここの無限ループがなんで起きるまではわからん
- 軽く調べたら同じ型の中に同じ型入れるだけだった
  - 最初からそう書け！！！！

次ここ
https://doc.rust-jp.rs/book-ja/ch15-02-deref.html#%E5%8F%82%E7%85%A7%E5%A4%96%E3%81%97%E6%BC%94%E7%AE%97%E5%AD%90%E3%81%A7%E5%80%A4%E3%81%BE%E3%81%A7%E3%83%9D%E3%82%A4%E3%83%B3%E3%82%BF%E3%82%92%E8%BF%BD%E3%81%84%E3%81%8B%E3%81%91%E3%82%8B
