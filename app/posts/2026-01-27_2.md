---
date: 2026-01-27 18:56
title: Rustの勉強[CLI作成編 その10]
category: ぎじゅつ
draft: false
tags:
  - Rust
---

## はじめに

<https://doc.rust-jp.rs/book-ja/>
を読んでいる

- 立川のゲームバーに行こうとしている

## お勉強

### メモ

https://doc.rust-jp.rs/book-ja/ch12-03-improving-error-handling-and-modularity.html#run%E9%96%A2%E6%95%B0%E3%81%8B%E3%82%89%E3%82%A8%E3%83%A9%E3%83%BC%E3%82%92%E8%BF%94%E3%81%99

- これからやる
- run関数内で利用するところから
- ん?機能実装した場所またなくなってるな、pushしたはずだが

- なおしたが、Configのstructの定義が`String`なのにsearchの定義が`str`になってるな
- 借用しなきゃだめか
- 自分の記述みすだったが、借用じゃなきゃだめだなって所に気がつけた
  - やったぜ

- grepができてそうなので実行する

```shell
❯ cargo run frog poem.txt
   Compiling minigrep v0.1.0 (/Users/r-aizawa/Repository/minigrep)
warning: unused import: `std::vec`
 --> src/lib.rs:4:5
  |
4 | use std::vec;
  |     ^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: `minigrep` (lib) generated 1 warning (run `cargo fix --lib -p minigrep` to apply 1 suggestion)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.28s
     Running `target/debug/minigrep frog poem.txt`
How public, like a frog
```

- 上手に動いてそうだ
- 使っていないimportもある

```shell
❯ cargo run body poem.txt
warning: unused import: `std::vec`
 --> src/lib.rs:4:5
  |
4 | use std::vec;
  |     ^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` (part of `#[warn(unused)]`) on by default

warning: `minigrep` (lib) generated 1 warning (run `cargo fix --lib -p minigrep` to apply 1 suggestion)
    Finished `dev` profile [unoptimized + debuginfo] target(s) in 0.00s
     Running `target/debug/minigrep body poem.txt`
I'm nobody! Who are you?
Are you nobody, too?
How dreary to be somebody!
```

- 複数マッチの場合
- いいじゃーーん

http://doc.rust-jp.rs/book-ja/ch12-05-working-with-environment-variables.html

- 環境変数きた
- goでもstructを使ったイメージ

> おまけの機能を追加してminigrepを改善します: 環境変数でユーザがオンにできる大文字小文字無視の検索用のオプションです

- たしかに

```rust
#[test]
    fn case_insensitive() {
        let query = "rUsT";
        // (最後の行のみ)
        // 私を信じて
        let contents = "\
Rust:
safe, fast, productive.
Pick three.
Trust me.";
        assert_eq!(
            vec!["Rust:", "Trust me."],
            search_case_insensitive(query, contents)
        );
    }
}
```

- このテストを書かされた
- 多分引数は同じなのでこう！！

```rust
fn search_case_insensitive<'a>(query: &str, contents: &'a str) -> Vec<&'a str> {
    vec![]
}
```

## まとめ

- だいぶ馴染んできた
- 今回もTDDでメソッドの憶測をした
- 明日やるところで答え合わせをする

次ここ

http://doc.rust-jp.rs/book-ja/ch12-05-working-with-environment-variables.html#search_case_insensitive%E9%96%A2%E6%95%B0%E3%82%92%E5%AE%9F%E8%A3%85%E3%81%99%E3%82%8B
