@import "tailwindcss" source("../app");
@plugin "daisyui";

@theme {
  /* Golden Ratio (phi = 1.618) Design Tokens */

  /* Spacing: base = 1rem */
  --spacing-phi-1: 0.236rem; /* 1/phi^3 */
  --spacing-phi-2: 0.382rem; /* 1/phi^2 */
  --spacing-phi-3: 0.618rem; /* 1/phi   */
  --spacing-phi-4: 1rem; /* base    */
  --spacing-phi-5: 1.618rem; /* phi     */
  --spacing-phi-6: 2.618rem; /* phi^2   */
  --spacing-phi-7: 4.236rem; /* phi^3   */
  --spacing-phi-8: 6.854rem; /* phi^4   */

  /*
   * Font Size
   * --line-height values are intentionally hardcoded rather than referencing
   * --leading-phi / --leading-phi-tight via var(). Reasons:
   *   1. @theme is processed at build time; var() is resolved at runtime,
   *      so Tailwind may not pick up the values for utility generation.
   *   2. These are mathematical constants derived from phi â€” they won't drift.
   *   3. Not all sizes share the same line-height (1.272, 1.15 have no
   *      corresponding --leading-* token), so var() would be partial at best.
   */
  --text-phi-sm: 0.618rem;
  --text-phi-sm--line-height: 1.618;
  --text-phi-base: 1rem;
  --text-phi-base--line-height: 1.618;
  --text-phi-lg: 1.272rem; /* sqrt(phi) */
  --text-phi-lg--line-height: 1.382;
  --text-phi-xl: 1.618rem; /* phi       */
  --text-phi-xl--line-height: 1.382;
  --text-phi-2xl: 2.058rem; /* phi^1.5   */
  --text-phi-2xl--line-height: 1.272;
  --text-phi-3xl: 2.618rem; /* phi^2     */
  --text-phi-3xl--line-height: 1.272;
  --text-phi-4xl: 3.33rem; /* phi^2.5   */
  --text-phi-4xl--line-height: 1.15;

  /* Border Radius */
  --radius-phi-sm: 0.382rem;
  --radius-phi-md: 0.618rem;
  --radius-phi-lg: 1rem;
  --radius-phi-xl: 1.618rem;

  /* Line Height */
  --leading-phi: 1.618;
  --leading-phi-tight: 1.382;
}

/* Article content styles */
@layer components {
  .prose-article h1 {
    @apply text-phi-3xl font-bold mt-phi-6 mb-phi-4;
  }
  .prose-article h2 {
    @apply text-phi-2xl font-bold mt-phi-5 mb-phi-3;
  }
  .prose-article h3 {
    @apply text-phi-xl font-bold mt-phi-4 mb-phi-2;
  }
  .prose-article h4 {
    @apply text-phi-lg font-bold mt-phi-3 mb-phi-2;
  }

  .prose-article blockquote {
    @apply border-l-4 border-base-300 pl-phi-4 my-phi-4 text-base-content/70;
  }

  .prose-article table {
    @apply w-full my-phi-4 border-collapse;
  }
  .prose-article th,
  .prose-article td {
    @apply border border-base-300 p-phi-2 text-left;
  }
  .prose-article th {
    @apply bg-base-200;
  }

  .prose-article ul {
    @apply pl-phi-5 my-phi-4 list-disc;
  }
  .prose-article ol {
    @apply pl-phi-5 my-phi-4 list-decimal;
  }
  .prose-article li {
    @apply my-phi-1;
  }
  .prose-article p {
    @apply my-phi-4;
  }

  .prose-article a {
    @apply link link-primary;
  }

  .prose-article code:not(pre code) {
    @apply bg-base-200 px-phi-2 py-phi-1 rounded text-sm font-mono text-error;
  }
}

/* Code block styles (Shiki) */
pre.shiki {
  position: relative;
  counter-reset: line;
  overflow-x: auto;
  padding: 1rem;
  border-radius: 0.5rem;
  font-size: 0.875rem;
}

.code-block-wrapper {
  @apply relative;
}

.code-block-wrapper .copy-button {
  @apply absolute top-2 right-2 z-10 opacity-0 transition-opacity;
}

.code-block-wrapper:hover .copy-button {
  @apply opacity-100;
}

.copy-button.copied {
  @apply btn-success;
}

.code-title {
  background: #1f2428;
  color: #e1e4e8;
  padding: 0.5rem 1rem;
  font-size: 0.85rem;
  border-bottom: 1px solid #444d56;
  font-family: ui-monospace, SFMono-Regular, Consolas, monospace;
}

pre.shiki .line::before {
  counter-increment: line;
  content: counter(line);
  display: inline-block;
  width: 2rem;
  margin-right: 1rem;
  text-align: right;
  color: #6a737d;
  user-select: none;
}

pre.shiki .line.diff.add {
  background-color: rgba(46, 160, 67, 0.2);
}
pre.shiki .line.diff.add::before {
  content: "+";
  color: #3fb950;
}

pre.shiki .line.diff.remove {
  background-color: rgba(248, 81, 73, 0.2);
}
pre.shiki .line.diff.remove::before {
  content: "-";
  color: #f85149;
}

pre.shiki .line.highlighted {
  background-color: rgba(56, 139, 253, 0.15);
}
pre.shiki .line.highlighted.error {
  background-color: rgba(248, 81, 73, 0.2);
}
pre.shiki .line.highlighted.warning {
  background-color: rgba(210, 153, 34, 0.2);
}

/* OGP card styles */
.ogp-card {
  @apply flex bg-base-100 border border-base-300 rounded-lg overflow-hidden my-6 no-underline shadow-md transition-shadow;
  min-height: 120px;
}
.ogp-card:hover {
  @apply shadow-xl no-underline;
}
.ogp-image {
  @apply flex items-center justify-center shrink-0 w-48 h-36 overflow-hidden bg-base-300;
}
.ogp-image img {
  @apply w-full h-full object-cover;
}
.ogp-noimage {
  @apply text-base-content/50 text-sm;
}
.ogp-content {
  @apply flex-1 p-4 flex flex-col justify-center;
}
.ogp-title {
  @apply block text-lg font-semibold mb-2 text-base-content;
}
.ogp-description {
  @apply block text-sm text-base-content/70 mb-2 overflow-hidden text-ellipsis whitespace-nowrap;
}
.ogp-site {
  @apply block text-xs text-base-content/50;
}

/* Post navigation */
.post-nav {
  @apply flex justify-between mt-8 pt-6 border-t border-base-300;
}
.post-nav a {
  @apply link link-primary max-w-[45%];
}
.post-nav-prev {
  @apply text-left;
}
.post-nav-next {
  @apply text-right ml-auto;
}

/* Mobile styles */
@media (max-width: 640px) {
  .ogp-card {
    @apply flex-col;
  }
  .ogp-image {
    @apply w-full h-44;
  }
  pre.shiki .line::before {
    display: none;
  }
  pre.shiki {
    font-size: 0.8rem;
  }
}
