---
date: 2026-02-14 02:27
title: Rustの勉強[Rc<T> その1]
category: ぎじゅつ
draft: false
tags:
  - Rust
---

## はじめに

<https://doc.rust-jp.rs/book-ja/>
を読んでいる

## お勉強

https://doc.rust-jp.rs/book-ja/ch15-04-rc.html

- ここやる
  - 不評だったらしい
- 光らせるをmemeにしていたが慣れてきた
  - もうちょっといい感じにしたい

### メモ

- 感想をかいていく
  - `rc〈T〉`だからジェネリクスの何か
  - 思ったより短い
  - 所有権を複数持てそうな雰囲気
  - 真意はまったくわからん

> 単独の値が複数の所有者を持つ可能性のある場合もあります。

- ここ光ってそうだな

> Rc\<T>は、参照カウント方式のスマートポインタ

- そもそもタイトルが光っているか？

> Rc\<T>を家族部屋のテレビと想像してください。
> 1人がテレビを見に部屋に入ったら、テレビをつけます。 他の人も部屋に入ってテレビを観ることができます。
> 最後の人が部屋を離れる時、 もう使用されていないので、テレビを消します。
> 他の人がまだ観ているのに誰かがテレビを消したら、 残りのテレビ視聴者が騒ぐでしょう！

- これね、多分不評だった場所

- うーん、憶測だけども全部使い終わったら一気に`drop`できるようなものなのかな

> Rc\<T>は、シングルスレッドの筋書きで使用するためだけのものであることに注意してください。 第16章で並行性について議論する時に、マルチスレッドプログラムで参照カウントをする方法を講義します。

- シングルスレッドだけらしい
- 使うか…？

![[Pasted image 20260213104746.jpg]]

- これがわかりやすかった

- いったんふわっとしていても進める

```rust
enum List {
    Cons(i32, Box<List>),
    Nil,
}

use List::{Cons, Nil};

fn main() {
    let a = Cons(5,
        Box::new(Cons(10,
            Box::new(Nil))));
    let b = Cons(3, Box::new(a));
    let c = Cons(4, Box::new(a));
}
```

- ここなんで`move`しているかわからんな
- そもそも長い式は関係なくて`Box`を代入すると`move`するんだった

## まとめ

- 思ったより全然進まなかったな
- 今の理解だとまとめられることがあんまりない
- `Box`で作成してエラーが起きるところを`Rc`で肩代わりできそうだった

次回は同じ場所
https://doc.rust-jp.rs/book-ja/ch15-04-rc.html#:~:text=%E4%BB%A3%E3%82%8F%E3%82%8A%E3%81%AB%E3%80%81List%E3%81%AE%E5%AE%9A%E7%BE%A9%E3%82%92%E3%83%AA%E3%82%B9%E3%83%8815%2D18%E3%81%AE%E3%82%88%E3%81%86%E3%81%AB%E3%80%81Box%3CT%3E%E3%81%AE%E7%AE%87%E6%89%80%E3%81%ABRc%3CT%3E%E3%82%92%E4%BD%BF%E3%81%86%E3%82%88%E3%81%86%E3%81%AB%E5%A4%89%E6%9B%B4%E3%81%97%E3%81%BE%E3%81%99%E3%80%82%20%E3%81%93%E3%82%8C%E3%81%A7%E5%90%84Cons%E5%88%97%E6%8C%99%E5%AD%90%E3%81%AF%E3%80%81%E5%80%A4%E3%81%A8List%E3%82%92%E6%8C%87%E3%81%99Rc%3CT%3E%E3%82%92%E4%BF%9D%E6%8C%81%E3%81%99%E3%82%8B%E3%82%88%E3%81%86%E3%81%AB%E3%81%AA%E3%82%8A%E3%81%BE%E3%81%97%E3%81%9F%E3%80%82
